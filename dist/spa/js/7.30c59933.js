(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{"0703":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"text-h3 q-mt-lg text-center text-grey-8 text-weight-light"},[e._v("\n    Research Groups\n  ")]),r("div",{staticClass:"q-pa-lg"},[r("div",{staticClass:"q-mt-md q-mb-md"},[r("q-btn-group",[r("q-btn",{attrs:{color:"red",icon:"leaderboard",label:"load"},on:{click:function(t){return e.buildChart()}}}),r("q-btn",{attrs:{color:"red",icon:"cached",label:"update"},on:{click:function(t){return e.buildChart()}}})],1),e.dataLoadingStatus?r("q-spinner-ios",{staticClass:"q-ml-md q-mr-md",attrs:{color:"light-blue",size:"2em"}}):e._e()],1),e.chart.chartOptions?r("div",{staticClass:"q-mb-lg"},[r("q-card",[r("q-card-section",[r("div",{staticClass:"q-pa-md"},[r("highcharts",{attrs:{options:e.chart.chartOptions}})],1)])],1)],1):e._e(),r("div",{staticClass:"q-mb-lg"},[e.chart?r("q-markup-table",[r("thead",[r("tr",e._l(e.chart.tableHeader,(function(t){return r("th",{key:t,staticClass:"text-left"},[e._v("\n              "+e._s(t)+"\n            ")])})),0)]),r("tbody",[e._l(e.chart.tableData,(function(t){return r("tr",{key:t.nid},e._l(t,(function(t,a){return r("td",{key:a,staticClass:"text-left"},[e._v("\n              "+e._s(t)+"\n            ")])})),0)})),r("tr",[r("td"),r("td"),e._l(e.chart.tableSums,(function(t){return r("td",{key:t,staticClass:"text-right"},[r("strong",[e._v(e._s(t.toFixed(2)))])])}))],2)],2)]):e._e()],1)])])},o=[],l=(r("13d5"),r("fb6a"),r("e6cf"),r("ddb0"),r("2b0e")),i=r("4452"),n=r("ea7f"),s=r.n(n),c=r("0319"),d=r.n(c),u=r("9955"),h=r.n(u),p=r("2ef0"),b=r.n(p);l["a"].use(i["Chart"]),d()(s.a);const f=r("2ef0");l["a"].use(h.a,{name:"cloneDeep",lodash:{cloneDeep:b.a}});var g={name:"Budget",components:{highcharts:i["Chart"]},data(){return{leftDrawerOpen:!0,dataLoadingStatus:!1,chart:!1}},methods:{removeArrayEmptyProperties(e){var t=e.length,r=Object.keys(e[0]).length,a=[];for(let o=0;o<r;o++){let r=0;e.forEach((function(e){let l=Object.keys(e)[o],i=e[l];""===i&&(r+=1,r==t&&a.push(l))}))}return a.length>0&&e.forEach((function(e){a.forEach((function(t){delete e[t]}))})),e},removeArrayProperties(e,t){var r=f.cloneDeep(e);return r.forEach((e=>{t.forEach((t=>{let r=t;delete e[r]}))})),r},columnChartSeries(e){let t=f.cloneDeep(e);var r=[];return t.forEach((function(e){var t={},a=[],o="";for(let[r,l]of Object.entries(e))"nid"!==r&&"field_proj_resgroup"!==r&&"field_rg_color"!==r&&"field_resgroup_abbreviation"!==r&&a.push(parseFloat(l)),"field_resgroup_abbreviation"===r&&(o=l),t.name=o,t.data=a,t.type="column";t.color=e.field_fin_color,r.push(t)})),r},columnChartCategories(e){let t=f.cloneDeep(e),r=this.removeArrayProperties(t,["nid","field_proj_resgroup","field_rg_color","field_resgroup_abbreviation"]);var a=[];for(let o of Object.keys(r[0])){let e=o.slice(-4);a.push(e)}return a},splineChartData(e){let t=f.cloneDeep(e),r=this.removeArrayProperties(t,["field_rg_color","field_resgroup_abbreviation"]);var a=r[0],o=Object.keys(a),l=o.length,i=[];for(let c=0;c<l;c++){var n=[],s=0;r.forEach((function(e){let t=Object.keys(e)[c],r=Object.values(e)[c];var a=0;if("field_proj_resgroup"!==t&&"nid"!==t){let e=r;a=""===e?0:parseFloat(r),n.push(a)}})),n.length>0&&(s=n.reduce((function(e,t){return e+t}),0),i.push(s))}return i},tableHeader(e){let t=f.cloneDeep(e),r=this.removeArrayProperties(t,["field_rg_color","field_resgroup_abbreviation"]);var a=r[0],o=[];return Object.entries(a).forEach((([e])=>{let t=e;if("nid"===t&&o.push("ID"),"field_proj_resgroup"===t&&o.push("Research group"),"field_proj_resgroup"!==t&&"nid"!==t){let e=t.slice(-4);o.push(e)}})),o},tableData(e){let t=f.cloneDeep(e),r=this.removeArrayProperties(t,["field_rg_color","field_resgroup_abbreviation"]);return r},async buildChart(){this.dataLoadingStatus=!0;const e=await fetch("json/rg.json");if(e.ok){let l=await e.json(),i=f.cloneDeep(l);var t=this.removeArrayEmptyProperties(i),r={title:{text:"Budget chart"},xAxis:{categories:this.columnChartCategories(t)},yAxis:{min:0,title:{text:"Total budget"},stackLabels:{enabled:!1,style:{fontWeight:"bold",color:s.a.defaultOptions.title.style&&s.a.defaultOptions.title.style.color||"gray"}}},legend:{layout:"vertical",align:"right",verticalAlign:"middle",backgroundColor:s.a.defaultOptions.legend.backgroundColor||"white",borderColor:"#CCC",borderWidth:1,shadow:!1},tooltip:{headerFormat:"<b>{point.x}</b><br/>",pointFormat:"{series.name}: {point.y}"},plotOptions:{column:{stacking:"normal",dataLabels:{enabled:!1}}},series:this.columnChartSeries(t)},a={type:"spline",name:"Total",data:this.splineChartData(t),color:"#88021a",marker:{lineWidth:2,lineColor:"#88021a",fillColor:"white"}};r.series.push(a);var o={};o.tableHeader=this.tableHeader(t),o.tableData=this.tableData(t),o.tableSums=this.splineChartData(t),o.chartOptions=r,this.chart=o}else alert("Error HTTP: "+e.status);this.dataLoadingStatus=!1}}},_=g,m=r("2877"),v=r("e7a9"),C=r("9c40"),y=r("d9b2"),k=r("f09f"),D=r("a370"),j=r("2bb1"),O=r("eebe"),q=r.n(O),x=Object(m["a"])(_,a,o,!1,null,null,null);t["default"]=x.exports;q()(x,"components",{QBtnGroup:v["a"],QBtn:C["a"],QSpinnerIos:y["a"],QCard:k["a"],QCardSection:D["a"],QMarkupTable:j["a"]})}}]);